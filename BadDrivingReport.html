<!-- Index.html  -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" 
          content="width=device-width,
                   initial-scale=1.0">
    <!-- Linking css file  -->

    <link rel="stylesheet" href="https://aplazere.github.io/AntisocialDrivers/Style.css">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <title>Survey Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #197819;
        }
        
        
        /* Form container  */
        .container {
            
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px
                rgba(0, 0, 0, 0.1);
        }
        
        .tooltip {
          position: relative;
          display: inline-block;
          border-bottom: 1px dotted black; /* Add dots under the hoverable text */
          cursor: pointer;
        }
        
        .tooltiptext {
          font-size: auto;
          visibility: hidden;
          width: max-content; 
          max-width: 200px;
          background-color: #4caf50;
          border-color: white;
          color: #fff;
          text-align: center;
          border-radius: 5px;
          padding: 7.5px;
          position: absolute;
          z-index: 1;
        }
        
        .tooltip:hover .tooltiptext {
          visibility: visible;
        }
        
        #gateway {
            display: block;
            border-style: solid;
            border-width: 3px ;
            background-color:white;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50%;
            border-radius: 5px;
            margin: 5px;
            z-index:1;
            
        }
        .gatewayTxt{
            font-size:18px;
            margin-left: 2%;
            font-weight: bold;
        }
        
        
        h1 {
            text-align: center;
        }
        
        label {
            margin-top: 1rem;
            font-size:25px;
        }
        #inputTitle {
        
            font-size: 36px;
            font-weight: bold;
        }
        
        input {
            padding: 10px;
            box-sizing: border-box;
            margin: 1.2rem 0;
        }
        select {
            background-color: #4caf50;
            color: #ffffff;
            padding: 10px;
            font-size: 25px;
        }
        
        #demo {
        
            transform: rotate(45deg)
        }
        
        
        
        /* Styling specific input types  */
        input[type="text"],
        input[type="number"] {
            width: 95%;
        }
        
        input[type="textarea"] {
            width: 100%;
            height: 1px;
        }
        input[type="checkbox"]{
          height: 1rem;
          width: 1rem;
          accent-color: #4caf50;
          background-color: #eee;
          color: #eee;
          
        
        }
        
        
        button {
            position:relative;
            left:5%;   
            width: 90%;
            padding: 10px;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .error {
            border: 3px solid red;
        }
        
        .errorText {
            padding: 1rem;
            border: 2px solid red;
            box-shadow: rgba(149, 157, 165, 0.2)
                0px 4px 12px;
            font-size: 1.2rem;
            font-family: "Lucida Sans",
                "Lucida Sans Regular",
                sans-serif;
        }
        
        .successText {
            padding: 1rem;
            border: 4px solid green;
            box-shadow: rgba(149, 157, 165, 0.2)
                0px 4px 12px;
            font-size: 1.2rem;
            font-family: "Lucida Sans",
                "Lucida Sans Regular",
                sans-serif;
        }
        
        #map {
                    border-style: solid;
                    border-width: 2.5px;
                    border-radius: 10px;
                    border-color:black;
                    height: 700px;
                    
                    margin: auto;
                    z-index:1
                }
        #wrapper{
            margin-left:-20px;
            margin-right:-20px;
            padding-left:20px;
            padding-right:20px;
            
            
            width:auto;
            background-color: rgb(206, 206, 206);
            border-radius: 5px;
            
        
        }
        
        .navigate{
            all: initial;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            position: absolute;
            font-weight: bold;
            font-size:50px;
            max-width: 20%;
            width: 20%;
            text-align: center
        
        }
        
        #navigateText{
            background-color: #4caf50;
            border-color: white;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 7.5px;
            position: absolute;
            z-index: 1;
            visibility:hidden;
        
        }
        .navigate:hover #navigateText {
            visibility: visible;
        
        
        }
        
        #titlebox{
            display: flex;
            flex-direction:column;
            justify-content:center;
             align-items: center;
            position: relative;
        }
        
        #requiredMark{
            color:red
        }

        #closer{
            all: initial;
            font-family: "Lucida Sans Unicode", "Arial Unicode MS";
            font-weight: bold;
            font-size: 24px;
            vertical-align: middle;
            position:fixed;
            top: 0%;
            right: 1%;
            cursor: pointer;
            
        }
        
    </style>
</head>

<body>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Creating the form container  -->
    <div class="container">
        <form  method="POST" id="myForm" action="https://script.google.com/macros/s/AKfycbwwGBes1_rfE0ymFxfcYcfeGoSa6xL6Y0FDteIAwrUUk5SWtpi-LuWzAbVNGHLTYu-r/exec">
        <div id="titlebox">
         <button class = "navigate" id="back"  type="button" style="left:0;">  << </button> <h1 style="font-size:48px; max-width:55%">Survey Form</h1> <button class = "navigate" id="next" type="button" style="right:0;">  >>  </button> 
        <br>
                

        </div>
        <!-- Contains error -->
        <h4 id="errorText"></h4>
        <div class="section" id="mandatory">
            <p style="top:20; text-align:center"> some text describing the mission statement and how to use this survey</p>
        <label for="Make" id="inputTitle">
                Car Make: <span id="requiredMark">*</span>
            </label><br>
        <!-- Form element  -->
        <input name="Make" type="text" maxlength="30"  list="carList" id="carSearchBox" name="carSearchBox" placeholder="search cars" autofocus autocomplete="on" required>
        <datalist id="carList"></datalist>
        
        

            <br>

            <label for="model" id="inputTitle">
                Model: 
            </label><br>

            
            
            <input type="text" 
                   id="model" 
                   name="Model">

                 
                 
                 <label for="isViolation" id="inputTitle">Improper Driving <span id="requiredMark">*</span> </label>
                    <input id="isViolation" style="opacity:0; display:block; position: absolute;pointer-events: none " required> 
                    <br> <br>
                   
            <!-- 
                    
            <input name="Rutabega" type="checkbox" id="rutabega" name="rutabega">
            <label for="rutabega"></label><br> 
            
            -->

            <!-- violations to add
             shoulder driving/line cutting
             emergency lane usage
             gta driving (find better word)
              -->

            <input name="Speeding" type="checkbox" id="speeding" name="speeding">
            <label for="speeding" class="tooltip">Speeding <span class="tooltiptext">driving faster than sorrounding traffic</span></label><br>

            <input name="Merge" type="checkbox" id="merge" name="merge">
            <label for="merge" class="tooltip"> Merging unsafely <span class="tooltiptext"> merging without signal, too close to other cars</span></label><br>

            <input name="Tailgate" type="checkbox" id="tailgate" name="tailgate">
            <label for="tailgate" class="tooltip">Tailgating <span class="tooltiptext">riding less than 1 car length away from the following car</span></label><br>

            <input name="Violation" type="checkbox" id="violation" name="violation">
            <label for="violation" class="tooltip">Traffic Violations <span class="tooltiptext"> running reds/stop signs, failure to yield, turning from wrong lane</span> </label><br>

            <input name="Distracted" type="checkbox" id="distracted" name="distracted">
            <label for="distracted" class="tooltip">Distracted driving <span class="tooltiptext"> occupying hands/eyes for a sustained period when traffic is flowing </span> </label><br>

            <input name="Shoulder" type="checkbox" id="shoulder" name="shoulder">
            <label for="shoulder">Driving on the shoulder</label><br>

             <input name="Weaving" type="checkbox" id="weaving" name="weaving">
            <label for="weaving">Weaving rapidly between lanes and around cars</label><br> 

            <input name="DoublePark" type="checkbox" id="doublePark" name="doublePark">
            <label for="doublePark">Double Parking</label><br>
       
       
             </div>
                   <br>
            <div class="section" style="display: none">
            <label id="inputTitle">
                state:
            </label>
            <select name="State" id="States">
                <option disabled selected value>Select A State</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="DC">District Of Columbia</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
                <option value="HI">Hawaii</option>
                <option value="ID">Idaho</option>
                <option value="IL">Illinois</option>
                <option value="IN">Indiana</option>
                <option value="IA">Iowa</option>
                <option value="KS">Kansas</option>
                <option value="KY">Kentucky</option>
                <option value="LA">Louisiana</option>
                <option value="ME">Maine</option>
                <option value="MD">Maryland</option>
                <option value="MA">Massachusetts</option>
                <option value="MI">Michigan</option>
                <option value="MN">Minnesota</option>
                <option value="MS">Mississippi</option>
                <option value="MO">Missouri</option>
                <option value="MT">Montana</option>
                <option value="NE">Nebraska</option>
                <option value="NV">Nevada</option>
                <option value="NH">New Hampshire</option>
                <option value="NJ">New Jersey</option>
                <option value="NM">New Mexico</option>
                <option value="NY" >New York</option>
                <option value="NC">North Carolina</option>
                <option value="ND">North Dakota</option>
                <option value="OH">Ohio</option>
                <option value="OK">Oklahoma</option>
                <option value="OR">Oregon</option>
                <option value="PA">Pennsylvania</option>
                <option value="RI">Rhode Island</option>
                <option value="SC">South Carolina</option>
                <option value="SD">South Dakota</option>
                <option value="TN">Tennessee</option>
                <option value="TX">Texas</option>
                <option value="UT">Utah</option>
                <option value="VT">Vermont</option>
                <option value="VA">Virginia</option>
                <option value="WA">Washington</option>
                <option value="WV">West Virginia</option>
                <option value="WI">Wisconsin</option>
                <option value="WY">Wyoming</option>
            </select>
            <br> <br>
            <label id="inputTitle">
               Plate Type
            </label>
            <br><br>
            <div id="Plate">
            <input name="Passenger" type="checkbox" id="passenger" name="passenger">
            <label for="passenger">Passenger Vehicle (standard) </label><br>

            <input name="Taxi" type="checkbox" id="taxi" name="taxi">
            <label for="taxi">Taxi & Limousine  </label><br>

            <input name="Commercial" type="checkbox" id="commercial" name="commercial">
            <label for="commerical">Commercial Vehicle </label><br>
            

            <input Name="City Vehicle" type="checkbox" id="govtNYC" name="govtNYC">
            <label for="govtNYC">City of New York (City Worker) </label><br>

            <input name="Motorcycle" type="checkbox" id="motorcycle" name="motorcycle">
            <label for="motorcycle">Motorcycle </label><br>

            <input name="Police" type="checkbox" id="cops" name="cops">
            <label for="cops">Police (local/state/federal)  </label><br>

            <input name="Vanity" type="checkbox" id="vanity" name="vanity">
            <label for="vanity">Vanity Plate  </label><br>

            <input name="Professional" type="checkbox" id="pro" name="pro">
            <label for="pro" class="tooltip">Profesional Plates <span class="tooltiptext"> Doctor, Registered Nurse, Architect etc. </span> </label><br>

            <input name="Dealer" type="checkbox" id="dealer" name="dealer">
            <label for="dealer">Car Dealer </label><br>

            <input type="checkbox" id="other" name="other" > <input id="otherText" name="Other Text" type="text" placeholder="Other (fill in here)">
             </div>
            <br>
            </div>
            <div class="section" style="display: none">
            <label id="inputTitle">Car Description</label> <br> <br>

            <label>Car Color: </label> <select name="Car Color" id="carColor">
                <option disabled selected value>Select A Color</option>
                <option>White</option>
                <option>Black</option>
                <option>Silver</option>
                <option>Gray</option>
                <option>Blue</option>
                <option>Red</option>
                <option>Green</option>
                <option>Brown/Beige</option>
                <option>Orange</option>
                <option>Gold</option>
                <option>Purple</option>
                <option>Yellow</option>
                <option>Pink</option>

            </select>
            <br>

            <input name="Modded" type="checkbox" id="modded" name="modded">
            <label for="modded">Custom Paint or Chassis </label><br>

            <input name="Damaged" type="checkbox" id="damaged" name="damaged">
            <label for="damaged">External Damage </label><br>

            <input name="Company" type="checkbox" id="company" name="company">
            <label for="company">Company Vehicle </label><br>
            </div>
           
            <div class="section" style="display: none">

            <label id="inputTitle">Time of Indicent</label>
            <select id="hourbox"><option disabled selected value> </option></select> <select id="minutebox"><option disabled selected value></option></select>  <select id="mbox"><option disabled selected value></option> <option>AM</option><option>PM</option></select>
            <input type="hidden" name="Time" id="time">
            <br><br>
            <div id="wrapper"> 
            <label id="inputTitle" style="margin: 0 px; padding: 0px;" onClick="showMap()">  Location  <span style=" position: relative;display: inline-block; font-size:20px; padding-top:5px" id="arrow" >&#9660</span></label>
            <div id="map"></div>
            <script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.4/leaflet.js"></script>
            
            <input type="hidden" name="ZIP code" id="ZIP">
            <h2 id="reportingZIP" style="display: none"></h2>
            </div>
            
            </div>
            <script>
                function makenew(value1, value2) {
                        var option = document.createElement('option');
                        option.text = value2;
                        option.value = value1;
                        return option;
                }

                var hourSelectionBox = document.getElementById('hourbox');
                for(var j = 1; j <= 12; j++){
                        hourSelectionBox.add(makenew(j, j));
                }

                var minutesSelectionBox = document.getElementById('minutebox');
                for(var j = 0; j < 60; j += 15) {
                        minutesSelectionBox.add(makenew(j, j));
                }

                
                addEventListener("click", (event) => { })
                onclick = (event) => {
                    var hour=document.getElementById('hourbox').value;
                    var minute=document.getElementById('minutebox').value;
                    var m =document.getElementById('mbox').value;
                    document.getElementById("time").value='=TIMEVALUE("'+hour+':'+minute+m+'")'
                
                }

                document.getElementById("myCheckbox").addEventListener("click", function(event){
                event.preventDefault()
                }); 
            </script>
            <script >
                 

            function getCars(Makes) {
            var Makes = [
            "Abarth",
            "Alfa Romeo",
            "Aston Martin",
            "Audi",
            "Bentley",
            "BMW",
            "Bugatti",
            "Cadillac",
            "Chevrolet",
            "Chrysler",
            "Citroën",
            "Dacia",
            "Daewoo",
            "Daihatsu",
            "Dodge",
            "Donkervoort",
            "DS",
            "Ferrari",
            "Fiat",
            "Fisker",
            "Ford",
            "GMC",
            "Honda",
            "Hummer",
            "Hyundai",
            "Infiniti",
            "Iveco",
            "Jaguar",
            "Jeep",
            "Kia",
            "KTM",
            "Lada",
            "Lamborghini",
            "Lancia",
            "Land Rover",
            "Landwind",
            "Lexus",
            "Lotus",
            "Maserati",
            "Maybach",
            "Mazda",
            "McLaren",
            "Mercedes-Benz",
            "MG",
            "Mini",
            "Mitsubishi",
            "Morgan",
            "Nissan",
            "Opel",
            "Peugeot",
            "Porsche",
            "Renault",
            "Rolls-Royce",
            "Rover",
            "Saab",
            "Seat",
            "Skoda",
            "Smart",
            "SsangYong",
            "Subaru",
            "Suzuki",
            "Tesla",
            "Toyota",
            "Volkswagen",
            "Volvo"
                ]
            var carList = document.getElementById("carList");
                //populate the cars datalist
                Makes.forEach(function(item) {
                        var carsOption = document.createElement('option');
                        
                        carsOption.value=item
                        carList.appendChild(carsOption)
                    });
                
            }   
                </script>
                <script type="text/javascript">
            var map = L.map('map').setView([40.703312, -73.97968], 10);
            //L.tileLayer('http://b.tilecloudmade.com/e7b61e61295a44a5b319ca0bd3150890/997/256/18/149531/108306.png', {
            L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
                maxZoom: 18,
                minZoom: 11,
                bounds: L.latLngBounds([40.486682593636445, -74.2585832834963], [40.91643308305091, -73.65739317418222])
            }).addTo(map);

            map.setMaxBounds(L.latLngBounds([40.486682593636445, -74.2585832834963], [40.91643308305091, -73.65739317418222]))

           function fetchJSON(url) {
            return fetch(url)
                .then(function(response) {
                return response.json();
                });
            }

            function submitZIP(zip){
                document.getElementById("ZIP").value = zip;
                document.getElementById("map").style.display='none';
                document.getElementById("arrow").style.rotate="180deg";
                document.getElementById("reportingZIP").innerHTML= "The incident reported occured in: " + zip;
                document.getElementById("reportingZIP").style.display='block';
                map.closePopup();

            }
            function showMap(){
                document.getElementById("map").style.display='block'
                document.getElementById("arrow").style.rotate="0deg"
                document.getElementById("reportingZIP").style.display='none';
            }

        
               
           
            

            const sectionElements = $('.section');
            let sectionIndex = 0;
           
              
                
            

            
                $('#next').click(function(){
                sectionIndex++;
                sectionElements.hide();
                $(sectionElements[sectionIndex]).show();
                sectionLimit();
                });

                $('#back').click(function(){
                sectionIndex--;
                sectionElements.hide();
                $(sectionElements[sectionIndex]).show();
                sectionLimit();
                });

                 function sectionLimit(){
                    if (sectionIndex == 0){
                        document.getElementById("back").style.display='none';
                    } else if (sectionIndex == sectionElements.length-1){
                        document.getElementById("next").style.display='none';
                    }else {
                        document.getElementById("back").style.display='block';
                        document.getElementById("next").style.display='block';
                    }
                    map.invalidateSize()
                    map.setMaxBounds(L.latLngBounds([40.486682593636445, -74.2585832834963], [40.91643308305091, -73.65739317418222]))

                 }
             
            
            var myPallete=['#0049ff', '#4e7ef8', '#73aee9', '#9edccd', '#fbff7c', '#c2c588', '#d3899e', '#c948b6', '#9000d7'];
            var data = fetchJSON('https://data.cityofnewyork.us/resource/pri4-ifjk.geojson').then(function(data) { 
                var layerGroup = L.geoJSON(data, {
                    onEachFeature: function (feature, layer) {
                        layer.bindPopup('<h1>'+feature.properties.modzcta+'<br><button type="button" onClick="submitZIP('+feature.properties.modzcta+')">Behavior occured in this ZIP code</button>');
                        var myFillColor= myPallete[feature.properties.modzcta.substr(4)]
                        layer.setStyle({
                            fillColor: myFillColor,
                            fillOpacity: 0.2,
                            weight: 1,
                            color: 'black'
                        })
                    }
                }).addTo(map);

                    // do what you want to do with `data` here...
                    // data.features.forEach(function(feature) {
                    //         L.geoJSON(feature).addTo(map)
                    //         L.geoJSON(feature, {
                    //             onEachFeature: onEachFeature
                    //         }).addTo(map)
                    //     });

            });

            function togglediv(id) {
            document.getElementById("isViolation").value="";
            var form=document.getElementById("myForm")

            var goodboy=0;
            document.getElementById("myForm").querySelectorAll("div#mandatory > input[type='checkbox']").forEach(function(i){
                if (i.checked == true){
                    goodboy++;
                }

            })

                if (goodboy > 0){
                document.getElementById("isViolation").value="eeyup"
                }
            
            var check=form.reportValidity();
            
            
            
            
            if (check==true){
            
            var div = document.getElementById(id);
            div.style.display = div.style.display == "none" ? "block" : "none";
            document.getElementById('makeVal').innerHTML="Make: " + document.getElementById('carSearchBox').value
            document.getElementById('modelVal').innerHTML="model: " + document.getElementById('model').value
            document.getElementById('stateVal').innerHTML="License State: " + document.getElementById('States').value
            document.getElementById('colorVal').innerHTML="Color: " + document.getElementById('carColor').value
             temptime=document.getElementById('time').value.replace('=TIMEVALUE("','');
             temptime= temptime.substring(0, temptime.length - 2)

            document.getElementById('timeVal').innerHTML="Time of Occurrence: " + temptime
            document.getElementById('locationVal').innerHTML="Location of Occurrence: " + document.getElementById('ZIP').value





             // collect checkboxes
            var violations="";
             document.getElementById("myForm").querySelectorAll("div#mandatory > input[type='checkbox']").forEach(function(i){
                if (i.checked == true){
                   violations=violations +" " + i.labels[0].innerText + ",";

                }
            
                


             })
             violations = violations.substring(0, violations.length - 1)
            document.getElementById('violationVal').innerHTML = "Violations: " + violations

             var plate=""
            document.getElementById("myForm").querySelectorAll("div#Plate > input[type='checkbox']").forEach(function(i){
                if (i.checked == true){
                    if (i.name == 'other'){
                        plate=plate + " " + document.getElementById("otherText").value + ","

                    }else{
                        plate=plate +" " + i.labels[0].innerText + ",";

                    }
                   

                }
            
            
                


             })
             plate= plate.substring(0, plate.length - 1)
             document.getElementById('plateVal').innerHTML = "Plate Info: " + plate;
             
             


             //generate a short paragraph someday (seems like a lot of work lol)
             
            
        } else {
            const sectionElements = $('.section')
            sectionElements.hide()
            $(sectionElements[0]).show();
             sectionLimit();
             form.reportValidity()
             

        }
    }
        

            

            </script>
            <script>window.onload=getCars;</script>


            <br>
            <button onClick="togglediv('gateway')" type="button">Submit</button>

            <div id="gateway" style="display:none">
            <span id="closer" onClick="togglediv('gateway')"> &#10006; </span>
            <br><br>
            <span class="gatewayTxt" id="makeVal"></span>
            <br><br>
            <span class="gatewayTxt" id="modelVal"></span>
            <br><br>
            <span class="gatewayTxt" id="violationVal"></span>
            <br><br>
            <span class="gatewayTxt" id="stateVal"></span>
            <br><br>
            <span class="gatewayTxt" id="plateVal"></span>
            <br><br>
            <span class="gatewayTxt" id="colorVal"></span>
            <br><br>
            <span class="gatewayTxt" id=timeVal></span>
            <br><br>
            <span class="gatewayTxt" id="locationVal"></span>
            <br><br>
            <button  type="submit">
                Submit
            </button>
            <br><br>
            </div>
            
        </form>
    </div>

    <!-- linking javascript file  -->
</body>


</html>










